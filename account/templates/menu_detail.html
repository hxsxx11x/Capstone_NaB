{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>메뉴 정보</title>
    <!-- 부트스트랩 CDN 추가 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/basic.css'%}" />
    <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <style>
        .bar-chart {
          display: flex;
          flex-direction: row-reverse; /* 막대를 가로로 나타내기 위해 역순으로 배치합니다. */
          align-items: center; /* 막대를 수직 가운데로 정렬합니다. */
          width: 100%;
          height: 50px; /* 그래프의 높이를 설정합니다. */
          padding: 10px;
        }
        .bar {
            display: flex;
            align-items: center;
            color:white;
            justify-content: center;
            background-color: #3498db;
            height: 100%; /* 막대의 높이를 그래프의 높이에 맞춥니다. */
        }
      </style>
</head>
<body>
  <nav class="navigator" style="min-width:400px">
    <a class="logo" href="{% url 'account:profile'%}">
      <img src="https://i.postimg.cc/kG1hkr9z/image.png" alt="Logo">
    </a>
    <ul style="float:right;">
      <li class="list_left"><a class="nav_a font" href="{% url 'image:upload'%}">체성분 분석</a></li>
      <li class="list_left"><a class="nav_a font" href="{% url 'account:biagraph'%}">체성분 기록</a></li>
      <li class="list_left"><a class="nav_a font" href="{% url 'account:userInformation'%}">마이페이지</a></li>
      <li class="list_left"><a class="nav_a font" href="{% url 'account:logout'%}">로그아웃</a></li>
  </ul>
</nav>
    <h1 class=" text-center bottom-border" style="margin-top:10px;">식단 칼로리 계산</h1> <!-- 아래쪽 여백 추가 -->
    <div class="container">
        <div>
            <i class="bi bi-arrow-left back-btn" onclick="history.back()"></i>
            <span class="back-btn font" onclick="history.back()">뒤로가기</span>
        </div>
        <table class="table table-striped table-bordered" style="margin-top:20px;">
            <thead class="thead-dark">
                <tr>
                    <th class="text-center">메뉴</th>
                </tr>
            </thead>
            <tbody>
                {% for diet_menu in diet_menulist %}
                <tr>
                    <td class="text-center">{{ diet_menu }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
              // carbohydrate, protein, province의 값을 가져옵니다.
              var carbohydrateValue = parseInt(document.getElementById('carbohydrate').getAttribute('data-width'));
              var proteinValue = parseInt(document.getElementById('protein').getAttribute('data-width'));
              var provinceValue = parseInt(document.getElementById('province').getAttribute('data-width'));
          
              // carbohydrate, protein, province의 값을 퍼센트로 변환합니다.
              var totalValue = carbohydrateValue + proteinValue + provinceValue;
              var carbohydrateWidth = (carbohydrateValue / totalValue) * 100;
              var proteinWidth = (proteinValue / totalValue) * 100;
              var provinceWidth = (provinceValue / totalValue) * 100;
          
              // 그래프의 너비를 조정합니다.
              document.getElementById('carbohydrate').style.width = carbohydrateWidth + '%';
              document.getElementById('protein').style.width = proteinWidth + '%';
              document.getElementById('province').style.width = provinceWidth + '%';
              document.getElementById('carbohydrate').innerText = carbohydrateWidth.toFixed(1) + '%';
              document.getElementById('protein').innerText = proteinWidth.toFixed(1) + '%';
              document.getElementById('province').innerText = provinceWidth.toFixed(1) + '%';

            });
          </script>
        <div class="text-center" style="margin-top:30px;">
            <h5><strong>총 칼로리:</strong> {{ kcal }}kcal</h5>
        </div>
        <div class="row text-center" style="margin-top:30px;">
            <p class="col-4"><strong><svg xmlns="http://www.w3.org/2000/svg" style="color: #825DEB;"width="17" height="17" fill="currentColor" class="bi bi-circle-fill" viewBox="0 0 16 16">
                <circle cx="8" cy="8" r="8"/>
              </svg> 탄수화물:</strong> {{ carbohydrate | floatformat:1 }}g</p>
            <p class="col-4"><svg xmlns="http://www.w3.org/2000/svg" style="color: #209BFB;"width="17" height="17" fill="currentColor" class="bi bi-circle-fill" viewBox="0 0 16 16">
                <circle cx="8" cy="8" r="8"/>
              </svg><strong> 단백질:</strong> {{ protein | floatformat:1 }}g</p>
            <p class="col-4"><svg xmlns="http://www.w3.org/2000/svg" style="color: #5ec987;"width="17" height="17" fill="currentColor" class="bi bi-circle-fill" viewBox="0 0 16 16">
                <circle cx="8" cy="8" r="8"/>
              </svg><strong> 지방:</strong> {{ province | floatformat:1 }}g</p>
        </div>
        <div class="bar-chart">

              <div class="bar" id="province" style="background-color:#5ec987;" data-width="{{ province }}"></div>
              <div class="bar" id="protein" style="background-color:#209BFB;" data-width="{{ protein }}"></div>
              <div class="bar" id="carbohydrate" style="background-color:#825DEB;" data-width="{{ carbohydrate }}"></div>
          </div>
        <div class="row justify-content-center mt-4">
            <a href="{% url 'account:profile' %}" class="btn">메인 화면으로 돌아가기</a>
        </div>
    </div>
    <!-- 부트스트랩 JS 추가 -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
