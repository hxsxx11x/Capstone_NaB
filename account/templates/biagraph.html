{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>체성분 기록</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    {% comment %} <link rel="stylesheet" href="{% static 'css/bootstrap.css'%}" /> 부트스트랩4 온라인 링크 오류날 시 사용{% endcomment %}
    <link rel="stylesheet" href="{% static 'css/basic.css' %}">
    <link
      href="https://cdn.rawgit.com/moonspam/NanumSquare/master/nanumsquare.css"
      rel="stylesheet"
    />
    <link
      href="https://i.postimg.cc/xdmYFx3Q/1.png"
      rel="shortcut icon"
      type="image/x-icon"
    />
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
     

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #fff;
        }

        h1 {
            text-align: center;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .back-btn {
            cursor: pointer;
            color: #007bff;
        }

        .date-info {
            text-align: center;
            margin-top: 20px;
            font-size: 20px;
            color: #555;
        }

        .graph-section {
            text-align: center;
            margin-top: 30px;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 20px;
            background-color: #FFFFFF;
            height: 100%;
            width: 40%;
            margin-left: auto; 
            margin-right: auto; 
        }

        .meal-title {
            text-align: center;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: #333; /* Change text color to black */
        }
        .date-border{
          border: 2px solid #ccc;
          border-radius: 10px;
        }
    </style>
</head>
<body>
<nav class="navigator" style="min-width:400px">
    <a class="logo" href="{% url 'account:profile'%}">
    <img src="https://i.postimg.cc/kG1hkr9z/image.png" alt="Logo">
    </a>
    <ul style="float:right;">
        <li class="list_left"><a class="nav_a font" href="{% url 'image:upload'%}">체성분 분석</a></li>
        <li class="list_left"><a class="nav_a font" href="{% url 'account:biagraph'%}">체성분 기록</a></li>
        <li class="list_left"><a class="nav_a font" href="{% url 'account:userInformation'%}">마이페이지</a></li>
        <li class="list_left"><a class="nav_a font" href="{% url 'account:logout'%}">로그아웃</a></li>
    </ul>
</nav>
      <h2 class="font text-center bottom-border" style="margin-top:10px;">체성분 기록</h2>
<div style="padding-left:100px; padding-right:100px; padding-bottom:30px;">
    <div>
        <i class="bi bi-arrow-left back-btn" onclick="history.back()"></i>
        <span class="back-btn" onclick="history.back()">뒤로가기</span>
    </div>

    <div class="d-flex justify-content-center date-border" style="font-size:30px; margin-top:10px"> 
      <div id="current_date">
        <script>
          date = new Date();
          year = date.getFullYear();
          month = date.getMonth() + 1;
          day = date.getDate();
          document.getElementById("current_date").innerHTML =
            year + "년 " + month + "월 " + day + "일";
        </script>
      </div>
    </div>

    <div class="graph-section">
        <h3 class="meal-title">체성분 기록 그래프</h3>
        
        <div id="chart"></div>
          <script>
              // django에서 데이터 전달
              var dates = {{ dates|safe }};
              var weights = {{ weights|safe }};
              var bmi = {{ bmi|safe }};
              var skeletal = {{ skeletal|safe }};
              var fat_per = {{ fat_per|safe }};
              var fat = {{ fat|safe }};

var options = {
    chart: {
        type: 'line',
        height: '500px' // 고정된 높이 설정
    },
    series: [
        { name: '몸무게', data: weights },
        { name: '골격근량', data: skeletal },
        { name: '체지방량', data: fat },
        { name: '체지방률', data: fat_per },
    ],
    xaxis: {
        categories: dates
    },
    yaxis: {
        min: function(min) {
            return Math.floor(min * 0.95); // 데이터 최소값보다 약간 낮게 설정
        },
        max: function(max) {
            return Math.ceil(max * 1.05); // 데이터 최대값보다 약간 높게 설정
        }
    }
};

var chart = new ApexCharts(document.querySelector("#chart"), options);
chart.render();

          </script>
    </div>

    {% comment %} <div class="graph-section">
        <h3 class="meal-title">선택 날짜 체성분 정보</h3>
        <div class="date-info">
            <label for="selected-date">날짜 선택:</label>
            <input type="date" id="selected-date">
            <button onclick="changeDate()">선택</button>
        </div>
    </div> {% endcomment %}
    </div>
</div>
</body>
</html>